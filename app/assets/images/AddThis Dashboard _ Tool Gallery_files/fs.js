try{"undefined"===typeof WeakMap&&function(){var l=Object.defineProperty,z=Date.now()%1E9,a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(z++ +"__")};a.prototype={set:function(a,f){var d=a[this.name];d&&d[0]===a?d[1]=f:l(a,this.name,{value:[a,f],writable:!0})},get:function(a){var f;return(f=a[this.name])&&f[0]===a?f[1]:void 0}};window.WeakMap=a}()}catch(e$$12){};try{(function(l){function z(){s=!1;var b=r;r=[];b.sort(function(a,b){return a.uid_-b.uid_});var c=!1;b.forEach(function(b){var e=b.takeRecords();a(b);e.length&&(b.callback_(e,b),c=!0)});c&&z()}function a(a){a.nodes_.forEach(function(b){(b=e.get(b))&&b.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function k(a,b){for(var c=a;c;c=c.parentNode){var h=e.get(c);if(h)for(var g=0;g<h.length;g++){var d=h[g],n=d.options;(c===a||n.subtree)&&(n=b(n))&&d.enqueue(n)}}}function f(a){this.callback_=
a;this.nodes_=[];this.records_=[];this.uid_=++q}function d(a,b){this.type=a;this.target=b;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function c(a,b){return w=new d(a,b)}function b(a){if(u)return u;var b=w,c=new d(b.type,b.target);c.addedNodes=b.addedNodes.slice();c.removedNodes=b.removedNodes.slice();c.previousSibling=b.previousSibling;c.nextSibling=b.nextSibling;c.attributeName=b.attributeName;c.attributeNamespace=
b.attributeNamespace;c.oldValue=b.oldValue;u=c;u.oldValue=a;return u}function h(a,b,c){this.observer=a;this.target=b;this.options=c;this.transientObservedNodes=[]}var e=new WeakMap,g=window.msSetImmediate;if(!g){var n=[],m=String(Math.random());window.addEventListener("message",function(a){a.data===m&&(a=n,n=[],a.forEach(function(a){a()}))});g=function(a){n.push(a);window.postMessage(m,"*")}}var s=!1,r=[],q=0;f.prototype={observe:function(a,b){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||
a;if(!b.childList&&!b.attributes&&!b.characterData||b.attributeOldValue&&!b.attributes||b.attributeFilter&&b.attributeFilter.length&&!b.attributes||b.characterDataOldValue&&!b.characterData)throw new SyntaxError;var c=e.get(a);c||e.set(a,c=[]);for(var g,d=0;d<c.length;d++)if(c[d].observer===this){g=c[d];g.removeListeners();g.options=b;break}g||(g=new h(this,a,b),c.push(g),this.nodes_.push(a));g.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){a=e.get(a);for(var b=0;b<a.length;b++){var c=
a[b];if(c.observer===this){c.removeListeners();a.splice(b,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var w,u;h.prototype={enqueue:function(a){var b=this.observer.records_,c=b.length;if(0<b.length){var e=b[c-1];e=e===a?e:!u||e!==u&&e!==w?null:u;if(e){b[c-1]=e;return}}else r.push(this.observer),s||(s=!0,g(z));b[c]=a},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",
this,!0);b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.addEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0);b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.removeEventListener("DOMNodeInserted",
this,!0);(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var b=e.get(a);b||e.set(a,b=[]);b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=e.get(a);for(var b=0;b<a.length;b++)if(a[b]===this){a.splice(b,1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var e=
a.attrName,h=a.relatedNode.namespaceURI,g=a.target,d=new c("attributes",g);d.attributeName=e;d.attributeNamespace=h;var n=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;k(g,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(e)||-1!==a.attributeFilter.indexOf(h)))return a.attributeOldValue?b(n):d});break;case "DOMCharacterDataModified":g=a.target;d=c("characterData",g);n=a.prevValue;k(g,function(a){if(a.characterData)return a.characterDataOldValue?
b(n):d});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var g=a.relatedNode,m=a.target,s;"DOMNodeInserted"===a.type?(a=[m],s=[]):(a=[],s=[m]);var f=m.previousSibling,m=m.nextSibling,d=c("childList",g);d.addedNodes=a;d.removedNodes=s;d.previousSibling=f;d.nextSibling=m;k(g,function(a){if(a.childList)return d})}w=u=void 0}};l.JsMutationObserver=f;!l.MutationObserver&&l.WebKitMutationObserver&&(l.MutationObserver=l.WebKitMutationObserver);l.MutationObserver||(l.MutationObserver=
f)})(this)}catch(e$$15){};(function(){var l;(function(a){var k;a.$entry=function(a){return a&&a.apply?function(){try{return a.apply(this,arguments)}catch(d){}}:a};a.logIfDebug=function(f){a.isDebug()&&window.console&&console.log(f)};a.logFSError=function(a){};a.stringify=function(a,d){var c=Array.prototype.toJSON,b=String.prototype.toJSON,h=[],e=function(a,b){if("object"!=typeof b)return b;var c=h.indexOf(this)+1;h.splice(c);var e;e="object"===typeof Node?b instanceof Node:b&&"object"===typeof b&&0<b.nodeType&&"string"===
typeof b.nodeName;if(e)return b.tagName?(c=b.tagName.toLowerCase(),c="<"+c+(b.attributes&&b.attributes.type?' type="'+b.attributes.type.value+'"':"")+(b.id?' id="'+b.id+'"':"")+(b.className?' class="'+b.className+'"':"")+">...</"+c+">"):c=b.nodeName+" "+b.data.substring(0,50)+(50<b.data.length?"...":""),c;if(c>=d)return"<"+b.constructor.name+">";0==c&&this.parent&&h.push(this.parent);if(-1<(c=h.indexOf(b)))return"<Cycle to ancestor #"+(h.length-c-1)+">";h.push(b);return b};try{return k||(k=window.JSON),
c&&delete Array.prototype.toJSON,b&&delete String.prototype.toJSON,void 0===a?'"undefined"':a&&a.constructor==Date?isNaN(a)?'"Invalid Date"':'"'+a.toUTCString()+'"':k.stringify(a,e)}catch(g){c="Internal error: unable to determine what JSON error was";try{c=""+g,c=c.replace(/[^a-zA-Z0-9\.\:\!\, ]/g,"_")}catch(n){}return'"'+c+'"'}finally{c&&(Array.prototype.toJSON=c),b&&(String.prototype.toJSON=b)}};a.parseJson=function(a){k||(k=window.JSON);return k.parse(a)}})(l||(l={}));(function(a){a.EVENT_MUT_INSERT=
2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=
33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_WINDOW_FOCUS=52;a.EVENT_WINDOW_BLUR=53;a.EVENT_HEARTBEAT=54;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_SYS_HIGHLIGHT=8194;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE="navigate";a.EVENT_COOKED_CLICK=
"click";a.EVENT_COOKED_TAP="tap";a.EVENT_COOKED_FOCUS="focus";a.EVENT_COOKED_CHANGE="change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.isUserActionEvent=function(k){switch(k){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};
a.MAX_LOGS_PER_PAGE=1024})(l||(l={}));(function(a){function k(){return window[f]}var f="_fs_loaded",d;a.Namespace=function(){d||(d=k()?k():window._fs_namespace?window._fs_namespace:"FS");return d};a.isLoaded=k;a.setLoaded=function(a){window[f]=a;a in window||(window[a]={})}})(l||(l={}));(function(a){var k=function(){function a(c,b){this.parent=c;this.combinator=b;this.classes={};this.attrs={};this.attrMatch={}}a.prototype.cssEscapeIdent=function(a){var b=function(a){return-1!="[]:./\\()@#%^&*'\" ".indexOf(a)?
"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "};return"-"==a?"\\-":"-"==a[0]?"-"+a.slice(1).replace(/([^0-9a-zA-Z-_])/g,b):a.replace(/[^0-9a-zA-Z-_]/g,b)};a.prototype.cssEscapeString=function(a){return'"'+a.replace(/[\x01-\x1f\"\\]/g,function(a){return'"'==a||"\\"==a?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "})+'"'};a.prototype.serialize=function(){var a=this.combinator?this.combinator:"";this.tag&&(a+="*"==this.tag?this.tag:this.cssEscapeIdent(this.tag));this.id&&(a+="#"+this.cssEscapeIdent(this.id));
var b=Object.keys(this.classes);b.sort();for(var h=0;h<b.length;h++)a+="."+this.cssEscapeIdent(b[h]);for(var e in this.attrs)a+="["+this.cssEscapeIdent(e)+this.attrMatch[e]+this.cssEscapeString(this.attrs[e])+"]";return a};return a}();a.SelectorRule=k;var f=function(){function a(c){this.rules=c}a.parse=function(c,b){void 0===b&&(b=null);c=c.trim();var h=new k(null,null),e=0,g=!1,n=function(){throw"Invalid selector";},m=function(){p=c[++e];if("\n"==p||null==p)throw n();if(p.match(/[0-9a-fA-F]/)){var a=
"";do a+=p,p=c[++e];while(p&&p.match(/[0-9a-fA-F]/));p&&p.match(/[\s]/)&&e++;return String.fromCharCode(parseInt(a,16))}e++;return p},f=function(){for(var a=e,b="",h;null!=(h=c[e]);)if("\\"==h)b+=m();else if(h.match(/[a-zA-Z0-9_\-]/)||128<h.charCodeAt(0))b+=h,e++;else break;if(a==e)throw n();return b},r=function(){for(;null!=c[e]&&c[e].match(/\s/);)e++},q=function(){g=!0;e++;var a=f().toLowerCase(),d;r();d=c[e];var k="=";if("*"==d||"|"==d||"^"==d||"$"==d||"~"==d)k=d+"=",e++;if(b&&!b[k])throw n();
if("="!=c[e])throw n();e++;r();d=k;p=c[e];'"'==p||"'"==p?(k=p,e++):k="]";for(var q="";(p=c[e])!=k;){if(null==p)throw n();if("\\"==p)q+=m();else{if("]"==k&&('"'==p||"'"==p))throw n();q+=p;e++}}e++;"]"!=k&&"]"==c[e]&&e++;h.attrs[a]=q;h.attrMatch[a]=d},w=function(){if(!g)throw n();g=!1;r();var a=c[e];">"==a||"+"==a||"~"==a?(e++,r()):a=" ";h=new k(h,a);if(b&&!b[a])throw n();};if(0==c.indexOf("//"))throw n();for(var u=0,e=0;e<c.length;){if(u++>2*c.length)throw console.log("Likely caught in an infinite loop while parsing "+
c),"Internal error, infinite loop";var p=c[e];switch(p){case "#":g=!0;e++;h.id=f();break;case "*":if(g)throw n();g=!0;h.tag="*";if(b&&!b["*"])throw n();e++;break;case ".":g=!0;e++;h.classes[f()]=!0;break;case "[":q();break;case " ":case ">":case "+":case "~":w();break;case ":":throw n();default:if(g)throw n();g=!0;h.tag=f().toLowerCase()}}if(!g)throw n();return new a(h)};a.prototype.serialize=function(){for(var a=null,b=this.rules;b;b=b.parent)a=a?b.serialize()+a:b.serialize();return a};return a}();
a.Selector=f})(l||(l={}));(function(a){function k(a){var c={};if(!a)return c;if(a.classList)for(var e=0;e<a.classList.length;++e)c[a.classList[e]]=!0;else if(a.className)for(a=(null!=a.className.animVal?a.className.animVal:a.className).split(" "),e=0;e<a.length;++e)c[a[e].trim()]=!0;return c}a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var f=function(){function a(b,c){this._parent=b;this._rule=c}a.prototype.parent=function(){return this._parent};a.prototype.matches=function(a,b){if(!a||
this._rule.tag&&a.tagName.toLowerCase()!=this._rule.tag||this._rule.id&&a.id!=this._rule.id)return!1;for(var c in this._rule.classes)if(!(c in b))return!1;for(var d in this._rule.attrs)if(a.getAttribute(d)!=this._rule.attrs[d])return!1;return this._parent?this._parent.matches(a.parentElement,k(a.parentElement)):!0};return a}();a.BlockRuleElem=f;var d=function(){function b(b){this.kind=b.Kind;this.selector=a.Selector.parse(b.Selector,{"=":!0,">":!0});var c=function(a){return new f(a.parent?c(a.parent):
null,a)};this.rules=c(this.selector.rules)}b.isComment=function(a){return!!a.match(/^\s*\/\//)};b.prototype.serialize=function(){return this.selector.serialize()};return b}();a.BlockRule=d;var c=function(){function a(){this._rules=[];this.rawRules=[]}a.prototype.isBlocked=function(a){for(var b=k(a),c=0;c<this._rules.length;++c)if(this._rules[c].rules.matches(a,b))return this._rules[c].kind;return null};a.prototype.addRule=function(a){this._rules.push(new d(a));this.rawRules.push(a)};a.prototype.mungeBlockedStyle=
function(a,b){var c=a.getBoundingClientRect(),d=Math.floor(c.width),c=Math.floor(c.height);if("object"==a.tagName.toLowerCase())for(var m=a.children,f=0;f<m.length;f++){var k=m[f];if("embed"==k.tagName.toLowerCase()){m=k.getBoundingClientRect();d=Math.max(d,Math.floor(m.width));c=Math.max(c,Math.floor(m.height));break}}m="";null!=b&&(m=b.trim());0<m.length&&";"!=m.charAt(m.length-1)&&(m+=";");if(0!=d||0!=c)m+="width:"+d+"px;height:"+c+"px;";return m};return a}();a.Blocker=c})(l||(l={}));(function(a){a.Node_ELEMENT_NODE=
1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=2;a.XHR_LOADING=3;a.XHR_DONE=4})(l||(l={}));(function(a){function k(a){return"_fsblocked"in a}function f(a,b){a._fsblocked=b}function d(a){return a?a._fs:null}
function c(a){return(a=d(a))?a.id:0}function b(a){if(a.parent&&(a.parent.child==a&&(a.parent.child=a.next),a.parent.lastChild==a&&(a.parent.lastChild=a.prev),a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),a.parent=a.prev=a.next=null,a.id=0,a.child))for(a=[a.child];0<a.length&&1E4>a.length;){var b=a.pop();b.id=0;b.next&&a.push(b.next);b.child&&a.push(b.child)}}function h(a,b){if(a.attributes&&0<a.attributes.length)for(var c=0;c<a.attributes.length;c++){var e=a.attributes[c];b(e.name,e.value)}}
a.isBlocked=k;a.blockKind=function(a){return a._fsblocked};a.setBlocked=f;a.mirrorFor=d;a.fsid=c;a.fsidIfNotBlocked=function(a){return k(a)?0:c(a)};a.removeMirror=b;var e=function(){function c(a,b){this._ctx=a;this._blocker=b;this._curId=1}c.prototype.curId=function(){return this._curId};c.prototype.tokenizeNode=function(a,c,e,h){var g=this._curId;try{var f=d(a),k=d(c);c=[];var p=this.tokeNode(e,c,h);p&&a&&(b(p),p.parent=f,k==f.child&&(f.child=p),p.next=k,null==k?(p.prev=f.lastChild,f.lastChild=p):
p.prev=k.prev,null!=p.prev&&(p.prev.next=p),null!=p.next&&(p.next.prev=p));return c}catch(l){return this._curId=g,[]}};c.prototype.tokeNode=function(b,c,e){if("SCRIPT"==b.nodeName||b.nodeType==a.Node_COMMENT_NODE)return null;var d={id:this._curId++,node:b};b._fs=d;var g=b.nodeName;"http://www.w3.org/2000/svg"==b.namespaceURI&&(g="svg:"+g);c.push("<"+g);try{if(this.processBlockedElem(b,c))return d;e&&e(b);h(b,function(a,b){c.push(":"+a);c.push(b)});if(b.firstChild){c.push("[");for(var g=null,f=b.firstChild;f;f=
f.nextSibling){var k=this.tokeNode(f,c,e);k&&(k.parent=d,g?(g.next=k,k.prev=g):d.child=k,g=d.lastChild=k)}c.push("]")}b.nodeType==a.Node_TEXT_NODE&&c.push(b.textContent)}catch(p){}return d};c.prototype.processBlockedElem=function(b,c){var e=this;if(b.nodeType==a.Node_ELEMENT_NODE&&this._blocker){var d=this._blocker.isBlocked(b);if(d){f(b,d);var g,k=!1;h(b,function(a,h){if("class"==a)h+=" _fs_block_"+d,g=!0;else if("style"==a)h=e._blocker.mungeBlockedStyle(b,h),k=!0;else if("value"==a||"checked"==
a||"src"==a)return;c.push(":"+a);c.push(h)});g||(c.push(":class"),c.push("_fs_block_"+d));k||(c.push(":style"),c.push(this._blocker.mungeBlockedStyle(b,"")));return!0}}return!1};return c}();a.NodeEncoder=e})(l||(l={}));(function(a){var k=function(){function a(){this.dict={idx:-1,map:{}};this.nodeCount=1;this.startIdx=0}a.prototype.encode=function(d){function c(){h?1<n.length?e.push([h.idx,n.length]):e.push(h.idx):e.push(n[0])}if(0==d.length)return[];for(var b=d[0],h=Object.prototype.hasOwnProperty.call(this.dict.map,
b)?this.dict.map[b]:null,e=[],g,n=[b],b=1;b<d.length;b++)if(g=d[b],h&&Object.prototype.hasOwnProperty.call(h.map,g))n.push(g),h=h.map[g];else{c();var m=this.startIdx+b-n.length;null==h&&this.nodeCount<a.MAX_NODES&&(h={idx:m,map:{}},this.dict.map[n[n.length-1]]=h,this.nodeCount++);this.nodeCount<a.MAX_NODES&&(h.map[g]={idx:m,map:{}},this.nodeCount++);n=[g];h=Object.prototype.hasOwnProperty.call(this.dict.map,g)?this.dict.map[g]:null}c();this.startIdx+=d.length;return e};a.MAX_NODES=1E4;return a}();
a.LZJGWEncoder=k;k=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=function(a){for(var c=this._seq.length,b=0;b<a.length;++b){var h=a[b];switch(typeof h){case "string":this._seq.push(h);break;case "number":this._seq.push(this._seq[h]);break;case "object":for(var e=0;e<h[1];e++)this._seq.push(this._seq[h[0]+e])}}return c};return a}();a.LZJGWDecoder=k})(l||(l={}));(function(a){var k=function(){function f(d,c,b){void 0===b&&(b=function(a,b){});
this._ctx=d;this._blocker=c;this._visitor=b;this._sentDomSnapshot=!1;this._records=[];this._lz=new a.LZJGWEncoder;this._encoder=new a.NodeEncoder(d,c)}f.prototype.hookMutations=function(a){var c=this;void 0===a&&(a=document.documentElement);this._root=a;this._sentDomSnapshot=!1;this._observer=new window.MutationObserver(function(a){c._records=c._records.concat(a)});this._observer.observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};f.prototype._unhookMutations=
function(){this._observer.disconnect()};f.prototype.processMutations=function(){if(!this._root)return[];var d=this._ctx.now(),c=[];this._sentDomSnapshot||(this.genInsert(d,c,null,this._root,null),this._sentDomSnapshot=!0);if(0==this._records.length)return c;var b={},h={};this.processRecords(d,c,h,b);for(var e in h){var g=e.split(":");c.push({Kind:a.EVENT_MUT_ATTR,When:d,Args:[parseInt(g[0]),g[1],h[e]]})}for(e in b)c.push({Kind:a.EVENT_MUT_TEXT,When:d,Args:[parseInt(e),b[e]]});this._records=[];return c};
f.prototype.processRecords=function(d,c,b,h){for(var e={},g={},n=0;n<this._records.length;++n)try{var m=this._records[n],f=a.fsid(m.target);if(f)switch(e[f]=m.target,m.type){case "childList":if(0<m.removedNodes.length)for(var k=0;k<m.removedNodes.length;++k){var q=a.mirrorFor(m.removedNodes[k]);q&&q.id&&q.parent==a.mirrorFor(m.target)&&q.next==a.mirrorFor(m.nextSibling)&&this.genRemove(d,c,q)}f&&(g[f]=m.target);break;case "characterData":var l=m.target.textContent;m.oldValue!=l&&(a.isBlocked(m.target)||
(h[f]=l));break;case "attributes":var u=m.attributeName;m.target.hasAttribute(u)?(l=m.target.getAttribute(u),m.oldValue!=l&&(l=this.rewriteAttr(m.target,u,l),null!==l&&(b[f+":"+u]=l))):b[f+":"+u]=null}}catch(p){}for(var B in g)b=g[B],(h=a.mirrorFor(b))&&h.id&&this.diff(d,c,b,h.child,b.firstChild);for(B in e)b=e[B],this.maybeAddPlaceholderResize(d,c,b)};f.prototype.diff=function(d,c,b,h,e){for(var g=[];h&&e;){var n=a.mirrorFor(e);a.fsid(e)?h.id==n.id?(h=h.next,e=e.nextSibling):(g.push({remove:h}),
h=h.next):(g.push({insert:[b,e,h.node]}),e=e.nextSibling)}for(;h;h=h.next)g.push({remove:h});for(;e;e=e.nextSibling)g.push({insert:[b,e,null]});for(b=0;b<g.length;b++)h=g[b],h.insert?this.genInsert(d,c,h.insert[0],h.insert[1],h.insert[2]):h.remove&&this.genRemove(d,c,h.remove)};f.prototype.maybeAddPlaceholderResize=function(d,c,b){try{for(;b&&!a.fsid(b);)b=b.parentNode;if(b&&a.isBlocked(b)){var h=b.getBoundingClientRect(),e=Math.floor(h.width),g=Math.floor(h.height);c.push({When:d,Kind:a.EVENT_PLACEHOLDER_SIZE,
Args:[a.fsid(b),e,g]})}}catch(n){}};f.prototype.genInsert=function(d,c,b,h,e){var g=this;if(b&&a.isBlocked(b))return null;var n=a.fsid(b)||-1,m=a.fsid(e)||-1;b=this._encoder.tokenizeNode(b,e,h,function(a){g._visitor(d,a)});0<b.length&&c.push({When:d,Kind:a.EVENT_MUT_INSERT,Args:[n,m,this._lz.encode(b)]})};f.prototype.genRemove=function(d,c,b){var h=b.id;a.removeMirror(b);if(0<c.length&&(b=c[c.length-1],b.Kind==a.EVENT_MUT_REMOVE)){b.Args.push(h);return}c.push({When:d,Kind:a.EVENT_MUT_REMOVE,Args:[h]})};
f.prototype.rewriteAttr=function(d,c,b){switch(c){case "style":a.isBlocked(d)&&(b=this._blocker.mungeBlockedStyle(d,b));break;case "class":a.isBlocked(d)&&0>b.indexOf("_fs_block_")&&(d=a.blockKind(d),b+=" _fs_block_"+d);break;case "value":a.isBlocked(d)&&(b=null)}return b};return f}();a.MutationWatcher=k})(l||(l={}));(function(a){function k(a,c){var d=Object.getOwnPropertyDescriptor(a.prototype,c);Object.defineProperty(a.prototype,c,{set:function(a){var c=this;setTimeout(function(){b(c)},0);return d.set.call(this,
a)},get:function(){return d.get.call(this)}})}function f(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return(a=a.value)||(a=""),""+a}}var d=function(){function d(c,h){var n=this;this._onchange=c;this._checkElem=h;this._fallback=!1;this._elems={};this._values={};b=function(b){var c=a.fsid(b);if(c&&(b=n._elems[c])){var e=f(b);e!=n._values[c]&&(n._onchange(b),n._values[c]=e)}}}d.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,
"value"))&&a.set?(c||(k(HTMLInputElement,"value"),k(HTMLInputElement,"checked"),k(HTMLSelectElement,"value"),k(HTMLTextAreaElement,"value"),c=!0),a=!0):a=!1;a||(this._fallback=!0)};d.prototype.addInput=function(b){var c=a.fsid(b);this._elems[c]=b;this._values[c]=f(b);this._values[c]&&this._onchange(b)};d.prototype.invokeGlobalOnChange=function(a){b(a)};d.prototype.tick=function(){if(this._fallback)for(var a in this._elems)if(this._checkElem(this._elems[a])){var b=this._elems[a],c=f(b);c!=this._values[a]&&
(this._onchange(b),this._values[a]=c)}else delete this._elems[a],delete this._values[a]};d.prototype._usingFallback=function(){return this._fallback};d.prototype._trackingElem=function(a){return!!this._elems[a]};return d}();a.InputWatcher=d;var c=!1,b;a.valueOfInputishElem=f})(l||(l={}));(function(a){function k(a){(a=a.target.tagName)&&(a=a.toLowerCase());return a}function f(a,b){return a.tagName&&a.tagName.toLowerCase()in b?!0:a.parentNode?f(a.parentNode,b):!1}var d=function(){function c(b,c,e,d){var n=
this;this._ctx=b;this._queue=c;this._blocker=e;this._onFrameCreated=d;this._curWindowScrollY=this._curWindowScrollX=-1;this._curInnerWidth=0;this._scrollTimeouts={};this._quirks=!1;this._quirks="BackCompat"==document.compatMode;this._currentUrl=location.href;this._watcher=new a.InputWatcher(function(a){n.addChangeElem(a)},function(b){return!!a.fsid(b)});this._mutHandler=new a.MutationWatcher(b,e,function(a,b){n.visitNode(a,b)})}c.prototype.onDomLoad=function(){var b=this;this.addDomLoaded();this.addResize();
this._mutHandler.hookMutations();this._watcher.hookEvents();document.documentElement.addEventListener("scroll",function(a){b.addScroll(a)},!0);window.addEventListener("mousemove",function(a){b.addMouseMove(a)},!0);window.addEventListener("mousedown",function(a){b.addMouseDown(a)},!0);window.addEventListener("mouseup",function(a){b.addMouseUp(a)},!0);window.addEventListener("keydown",function(a){b.addKeyDown(a)},!0);window.addEventListener("keyup",function(a){b.addKeyUp(a)},!0);window.addEventListener("scroll",
function(a){b.addWindowScroll()});window.addEventListener("resize",function(a){b.addResize()});window.addEventListener("submit",function(a){b.addFormSubmit(a)});window.addEventListener("click",function(a){b.addClick(a)},!0);window.addEventListener("dblclick",function(a){b.addDblClick(a)},!0);window.addEventListener("focus",function(a){b.addFocus(a)},!0);window.addEventListener("blur",function(a){b.addBlur(a)},!0);window.addEventListener("change",function(a){b.addChange(a)},!0);window.addEventListener("touchstart",
function(c){b.addTouchEvent(c,a.EVENT_TOUCHSTART);b.addWindowScroll()},!0);window.addEventListener("touchend",function(c){b.addTouchEvent(c,a.EVENT_TOUCHEND);b.addWindowScroll()},!0);window.addEventListener("touchmove",function(c){b.addTouchEvent(c,a.EVENT_TOUCHMOVE);b.addWindowScroll()},!0);window.addEventListener("touchcancel",function(c){b.addTouchEvent(c,a.EVENT_TOUCHCANCEL)},!0);window.addEventListener("play",function(c){b.addPlayPauseEvent(c,a.EVENT_PLAY)},!0);window.addEventListener("pause",
function(c){b.addPlayPauseEvent(c,a.EVENT_PAUSE)},!0);window.addEventListener("focus",function(a){b.addWindowFocus(a)},!1);window.addEventListener("blur",function(a){b.addWindowBlur(a)},!1);if(history.pushState){window.addEventListener("popstate",function(){b.addNavigate()});var c=this;this._oldPushState=history.pushState;history.pushState=function(a,b,d){c._oldPushState.call(this,a,b,d);c.addNavigate()};this._oldReplaceState=history.replaceState;history.replaceState=function(a,b,d){c._oldReplaceState.call(this,
a,b,d);c.addNavigate()}}};c.prototype._cleanupForTests=function(){this._mutHandler._unhookMutations();history.pushState=this._oldPushState;history.replaceState=this._oldReplaceState;this._oldReplaceState=this._oldPushState=null};c.prototype.onLoad=function(){this.addLoad()};c.prototype.bundleEvents=function(){this._watcher.tick();this.addWindowInnerWidth();return this._mutHandler.processMutations()};c.prototype.visitNode=function(b,c){switch(c.nodeName){case "INPUT":case "TEXTAREA":case "SELECT":this._watcher.addInput(c);
break;case "FRAME":case "IFRAME":this._onFrameCreated(b,c);break;case "VIDEO":case "AUDIO":c.paused||this.addPlayPauseEventById(a.fsid(c),a.EVENT_PLAY)}};c.prototype.addMouseMove=function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:[b.clientX,b.clientY];this._queue.enqueue(a.EVENT_MOUSEMOVE,b)};c.prototype.addMouseDown=function(b){this._queue.enqueue(a.EVENT_MOUSEDOWN,[b.clientX,b.clientY]);!f(b.target,{button:!0,a:!0,input:!0})||"input"==k(b)&&"submit"!=b.target.type||this._queue.singSwanSong()};
c.prototype.addMouseUp=function(b){this._queue.enqueue(a.EVENT_MOUSEUP,[b.clientX,b.clientY])};c.prototype.addTouchEvent=function(a,c){if(void 0!==a.changedTouches)for(var d=0;d<a.changedTouches.length;++d){var g=a.changedTouches[d];isNaN(parseInt(g.identifier))&&(g.identifier=0);this._queue.enqueue(c,[g.identifier,g.clientX,g.clientY])}};c.prototype.addPlayPauseEvent=function(b,c){var d=a.fsid(b.target);d&&this.addPlayPauseEventById(d,c)};c.prototype.addPlayPauseEventById=function(a,c){this._queue.enqueue(c,
[a])};c.prototype.addWindowFocus=function(b){this._queue.enqueue(a.EVENT_WINDOW_FOCUS,[])};c.prototype.addWindowBlur=function(b){this._queue.enqueue(a.EVENT_WINDOW_BLUR,[])};c.prototype.maybeAddValueChange=function(){var a=document.activeElement;a&&this._watcher.invokeGlobalOnChange(a)};c.prototype.addKeyDown=function(b){var c=document.activeElement;if(!c||a.fsidIfNotBlocked(c))this.maybeAddValueChange(),this._queue.enqueue(a.EVENT_KEYDOWN,[b.keyCode]);switch(k(b)){case "button":13!=b.keyCode&&32!=
b.keyCode||this._queue.singSwanSong();break;case "a":13==b.keyCode&&this._queue.singSwanSong();break;case "input":"submit"==b.target.type&&13==b.keyCode&&this._queue.singSwanSong()}};c.prototype.addKeyUp=function(b){var c=document.activeElement;if(!c||a.fsidIfNotBlocked(c))this.maybeAddValueChange(),this._queue.enqueue(a.EVENT_KEYUP,[b.keyCode])};c.prototype.addWindowInnerWidth=function(){var b=window.innerWidth;b!=this._curInnerWidth&&(this._queue.enqueue(a.EVENT_INNERWIDTH,[b]),this._curInnerWidth=
b)};c.prototype.doWorkInScrollTimeout=function(b,c){var d=this;b in this._scrollTimeouts||(this._scrollTimeouts[b]=c,setTimeout(function(){if(b in d._scrollTimeouts){var a=d._scrollTimeouts[b];delete d._scrollTimeouts[b];a()}},a.ScrollSampleInterval))};c.prototype._fireScrollTimeouts=function(){for(var a in this._scrollTimeouts)this._scrollTimeouts[a](),delete this._scrollTimeouts[a];this._scrollTimeouts=[]};c.prototype.addWindowScroll=function(){var b=this,c=a.fsid(document.body);c&&this.doWorkInScrollTimeout(c,
function(){var d,g;"pageXOffset"in window?(d=window.pageXOffset,g=window.pageYOffset):(d=document.body.scrollLeft,g=document.body.scrollTop);if(d!=b._curWindowScrollX||g!=b._curWindowScrollY)b._queue.enqueue(a.EVENT_SCROLL,[c,d,g]),b._curWindowScrollX=d,b._curWindowScrollY=g;b.addWindowInnerWidth()})};c.prototype.addScroll=function(b){var c=this,d=b.target,g=a.fsid(d);g&&this.doWorkInScrollTimeout(g,function(){c._queue.enqueue(a.EVENT_SCROLL,[g,d.scrollLeft,d.scrollTop])})};c.prototype.addResize=
function(){this._quirks?this._queue.enqueue(a.EVENT_RESIZE,[document.body.clientWidth,document.body.clientHeight]):this._queue.enqueue(a.EVENT_RESIZE,[document.documentElement.clientWidth,document.documentElement.clientHeight])};c.prototype.addDomLoaded=function(){this._queue.enqueue(a.EVENT_DOMLOADED,[])};c.prototype.addLoad=function(){this._queue.enqueue(a.EVENT_LOAD,[])};c.prototype.addNavigate=function(){var b=location.href;this._currentUrl!=b&&(this._currentUrl=b,this._queue.enqueue(a.EVENT_NAVIGATE,
[location.href,document.title]))};c.prototype.addClick=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_CLICK,[b])};c.prototype.addDblClick=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_DBL_CLICK,[b])};c.prototype.addFormSubmit=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_FORM_SUBMIT,[b])};c.prototype.addFocus=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_FOCUS,[b])};c.prototype.addBlur=function(b){(b=a.fsid(b.target))&&this._queue.enqueue(a.EVENT_BLUR,
[b])};c.prototype.addChange=function(a){this.addChangeElem(a.target)};c.prototype.addChangeElem=function(b){var c=a.fsidIfNotBlocked(b);c&&this._queue.enqueue(a.EVENT_VALUECHANGE,[c,a.valueOfInputishElem(b)])};return c}();a.EventWatcher=d})(l||(l={}));(function(a){function k(b,c){void 0===c&&(c=null);window._fs_transport?window._fs_transport.send(b,a.stringify(c)):parent.postMessage(a.stringify({__fs:[b,c?c:""]}),"*")}function f(b,c,d,e,h,g){void 0===g&&(g=null);c="//"+c+d;var f=new XMLHttpRequest;
if("withCredentials"in f)f.onreadystatechange=function(){f.readyState==a.XHR_DONE&&(200==f.status?h(f.responseText):g(f.status))},f.open("POST",b+c,!0),f.withCredentials=!0,f.setRequestHeader("Content-Type","text/plain"),f.send(e);else{var k=new XDomainRequest;k.onload=function(){h(k.responseText)};k.onerror=function(){g("Not Found"==k.responseText?404:500)};k.onprogress=function(){};k.open("POST",c);k.send(e)}}function d(b,c){var d=Math.min(a.BackoffMax,5E3*Math.pow(2,b));return c?d+0.25*Math.random()*
d:d}function c(a){return 400<=a||202==a?!0:!1}function b(a,b,c,d,e,h,g){a="/rec/bundle?OrgId="+a+"&UserId="+b+"&SessionId="+c+"&PageId="+d+"&Seq="+e.Seq;h&&(a+="&PageStartTime="+h);g&&(a+="&DeltaT="+g);return a}var h=function(){function b(a){void 0===a&&(a=new e);this._messagePoster=a}b.prototype.enqueueEvents=function(b){this._messagePoster.postMessage(a.FS_IFRAME_EVENTS,b)};b.prototype.setHost=function(a){};b.prototype.startPipeline=function(){};b.prototype.stopPipeline=function(){};b.prototype.flush=
function(){};b.prototype.singSwanSong=function(){};return b}();a.PostMessageEventTransport=h;var e=function(){function a(){}a.prototype.postMessage=function(a,b){k(a,b)};return a}();a.postMessageParent=k;h=function(){function d(b,c,e,h,f,k){void 0===f&&(f=a.RealTicker);void 0===k&&(k=new g);this._ctx=b;this._host=c;this._protocol=e;this._onShutdown=h;this._tickerFactory=f;this._poster=k;this._backoffTime=this._backoffRetries=this._byteCount=0;this._bundleSeq=1;this._lastPostTime=0;this._outgoingEventQueue=
[];this._bundleQueue=[];this._lastBundleTime=b.wallTime();this._uploadTicker=new this._tickerFactory(a.UploadInterval);this._swanSong=new a.SwanSong(b,this,f)}d.prototype.protocol=function(){return this._protocol};d.prototype.enqueueEvents=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};d.prototype.setHost=function(a){this._host=a};d.prototype.startPipeline=function(){var a=this;this.enqueueAndSendBundle();this._uploadTicker.start(function(){a.enqueueAndSendBundle()})};d.prototype.stopPipeline=
function(){this._uploadTicker.stop();this._outgoingEventQueue=[];this._bundleQueue=[]};d.prototype.flush=function(){this.maybeSendNextBundle()};d.prototype.singSwanSong=function(){0<this._outgoingEventQueue.length&&this.enqueueNextBundle();if(0<this._bundleQueue.length||this._pendingBundle){var a=this._bundleQueue.concat();this._pendingBundle&&a.unshift(this._pendingBundle);this._swanSong.sing(a,this._lastBundleTime)}};d.prototype.sendSwanSongBundle=function(a,c,d,e,h){void 0===h&&(h=null);c=b(this._ctx.identity().orgId(),
this._ctx.identity().userId(),this._ctx.identity().sessionId(),this._ctx.pageId(),a,c,d);this.post(c,a,e,h)};d.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};d.prototype.enqueueNextBundle=function(){var a={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(a);
this.maybeSendNextBundle()};d.prototype.maybeSendNextBundle=function(){this._ctx.pageId()&&(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};d.prototype._sendPendingBundle=function(){var b=this,d=this._ctx.wallTime();if(!(d<this._backoffTime)){var e=this._pendingBundle;this._pendingBundleFailed=!1;this._lastPostTime=this._lastBundleTime=d;this.sendBundle(e,function(c){a.logIfDebug("Sent bundle "+e.Seq+" with "+e.Evts.length+
" events");b._pendingBundle=null;b._backoffTime=0;b._backoffRetries=0;b._ctx.wallTime()-b._lastPostTime>a.UploadInterval&&b.maybeSendNextBundle()},function(d){a.logIfDebug("Failed to send events.");c(d)?b._onShutdown():(b._pendingBundleFailed=!0,b._backoffTime=b._lastPostTime+b._poster.exponentialBackoffMs(b._backoffRetries++,!1))})}};d.prototype.sendBundle=function(a,c,d){void 0===d&&(d=null);var e=b(this._ctx.identity().orgId(),this._ctx.identity().userId(),this._ctx.identity().sessionId(),this._ctx.pageId(),
a);this.post(e,a,c,d)};d.prototype.post=function(b,c,d,e){void 0===e&&(e=null);var h=null;null!=c&&(h=a.stringify(c),this._byteCount+=h.length,a.logIfDebug("total bytes written: "+this._byteCount));this._poster.post(this._protocol,this._host,b,h,d,e)};return d}();a.XHREventTransport=h;var g=function(){function a(){}a.prototype.post=function(a,b,c,d,e,h){void 0===h&&(h=null);f(a,b,c,d,e,h)};a.prototype.exponentialBackoffMs=function(a,b){return d(a,b)};return a}();a.doPost=f;a.exponentialBackoffMs=
d;a.isErrorFatal=c})(l||(l={}));(function(a){a.MutationProcessingInterval=250;a.CurveSamplingInterval=142;a.UploadInterval=5E3;a.UserInactivityTimeout=1E4;a.HeartbeatInitial=4E3;a.HeartbeatMax=256E3;a.PageInactivityTimeout=18E5;a.BackoffMax=3E5;a.ScrollSampleInterval=a.MutationProcessingInterval/5})(l||(l={}));(function(a){var k=function(){function a(c,b,d){this._ctx=c;this._q=b;this._valueIndices=d;this._evts=[]}a.prototype.add=function(a){0==this._evts.length&&this._q.push(a);this._evts.push(a)};
a.prototype.finish=function(a,b){var d=this._evts.length;if(1>=d)return!1;for(var e=this._evts[0].When,g=this._evts[d-1].When,f=0;f<this._valueIndices.length;++f){var k=this._valueIndices[f],l=this._evts[0].Args[k],r=(this._evts[1].When-e)/(g-e),q=(this._evts[1].Args[k]-l)/r,w=this._evts[d-1].Args[k],r=(g-this._evts[d-2].When)/(g-e);b.push(l,w,q,(w-this._evts[d-2].Args[k])/r)}this._evts[0].Kind=a;this._evts[0].Args=b;return!0};a.prototype.evts=function(){return this._evts};return a}(),f=function(){function d(a){this._ctx=
a;this._gotInitialScroll=!1}d.prototype.processQueue=function(c){if(0==c.length)return c;this.maybeAddInitialScroll();for(var b=this._ctx.now(),d=[],e=new k(this._ctx,d,[0,1]),g={},f={},m,l=0;l<c.length;++l){var r=c[l];switch(r.Kind){case a.EVENT_MOUSEMOVE:e.add(r);break;case a.EVENT_TOUCHMOVE:var q=r.Args[0];q in g||(g[q]=new k(this._ctx,d,[1,2]));g[q].add(r);break;case a.EVENT_SCROLL:q=r.Args[0];q in f||(f[q]=new k(this._ctx,d,[1,2]));f[q].add(r);break;case a.EVENT_INNERWIDTH:m||(m=new k(this._ctx,
d,[0]));m.add(r);break;default:d.push(r)}}e.finish(a.EVENT_MOUSEMOVE_CURVE,[b])&&(c=e.evts(),e=c[c.length-1].Args,2<e.length&&e[2]&&c[0].Args.push(e[2]));for(q in f)c=parseInt(q),f[c].finish(a.EVENT_SCROLL_CURVE,[b,c]);for(q in g)c=parseInt(q),g[c].finish(a.EVENT_TOUCHMOVE_CURVE,[b,c]);m&&m.finish(a.EVENT_INNERWIDTH_CURVE,[b]);return d};d.prototype.maybeAddInitialScroll=function(){!this._gotInitialScroll&&(document.body&&a.fsid(document.body))&&(this._ctx.addWindowScroll(),this._gotInitialScroll=
!0)};return d}();a.EventProcessor=f})(l||(l={}));(function(a){var k=function(){function f(d,c,b){void 0===b&&(b=a.RealTicker);this._ctx=d;this._transport=c;this._tickerFactory=b;this._recover()}f.prototype.sing=function(d,c){a.logIfDebug("Saving "+d.length+" bundles in swan-song.");var b={OrgId:this._ctx.identity().orgId(),UserId:this._ctx.identity().userId(),SessionId:this._ctx.identity().sessionId(),PageId:this._ctx.pageId(),Bundles:d,PageStartTime:this._ctx.startTime(),LastBundleTime:c};try{localStorage.singSwanSong=
a.stringify(b)}catch(h){}};f.prototype._recover=function(){try{if("singSwanSong"in localStorage){var d=localStorage.singSwanSong;delete localStorage.singSwanSong;var c=a.parseJson(d);c.Bundles&&c.UserId&&c.SessionId&&c.PageId?(c.OrgId||(c.OrgId=this._ctx.identity().orgId()),0<c.Bundles.length&&(a.logIfDebug("Sending "+c.Bundles.length+" bundles as prior page swan song"),this.sendSwanSongBundles(c.OrgId,c.UserId,c.SessionId,c.PageId,c.PageStartTime,c.Bundles,c.LastBundleTime))):a.logIfDebug("Malformed swan song found. Ignoring it.")}}catch(b){a.logIfDebug("Error recovering swan-song: "+
b)}};f.prototype.sendSwanSongBundles=function(d,c,b,h,e,g,f,k){var l=this;void 0===k&&(k=0);var r=null;g.constructor===Array&&(0!==g.length&&void 0!==g[0])&&(1==g.length&&(r=this._ctx.wallTime()-f),this._transport.sendSwanSongBundle(g[0],e,r,function(k){a.logIfDebug("Sent "+g[0].Evts.length+" trailing events from last session as Seq "+g[0].Seq);g.shift();0<g.length?l.sendSwanSongBundles(d,c,b,h,e,g,f):a.logIfDebug("Done with prior page swan song")},function(q){a.isErrorFatal(q)?a.logIfDebug("Fatal error while sending events, giving up"):
(a.logIfDebug("Failed to send events from last session, will retry while on this page"),l._lastSwanSongRetryTicker=new l._tickerFactory(a.exponentialBackoffMs(k,!0)),l._lastSwanSongRetryTicker.oneShot(function(){l.sendSwanSongBundles(d,c,b,h,e,g,f,k+1)}))}))};return f}();a.SwanSong=k})(l||(l={}));(function(a){var k=function(){function a(c){this._interval=c;this._handle=-1}a.prototype.oneShot=function(a){setTimeout(a,this._interval)};a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,
this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),this._handle=-1)};return a}();a.RealTicker=k;var f=function(){function d(c,b,d,e){void 0===d&&(d=function(){return[]});void 0===e&&(e=k);this._ctx=c;this._transport=b;this._gatherExternalEvents=d;this._tickerFactory=e;this._recordingDisabled=!1;this._lastWhen=-1;this._lastUserAction=0;this._quiescent=!1;this._lastHeartbeat=0;this._heartbeatInterval=a.HeartbeatInitial;this._eventQueue=[];this._gotUnload=!1;
this._sampleCurvesTicker=new this._tickerFactory(a.CurveSamplingInterval);this._processMutationsTicker=new this._tickerFactory(a.MutationProcessingInterval);this._processor=new a.EventProcessor(c)}d.prototype.startPipeline=function(){var a=this;this._recordingDisabled||this._pipelineStarted||(this._lastUserAction=this._ctx.now(),this.processEvents(),this._processMutationsTicker.start(function(){a.processEvents()}),this._sampleCurvesTicker.start(function(){a.processEvents(!0)}),this._transport.startPipeline(),
this._pipelineStarted=!0)};d.prototype.enqueue=function(a,b){this.enqueueAt(this._ctx.now(),a,b)};d.prototype.enqueueAt=function(c,b,d){this._recordingDisabled||(c<=this._lastWhen&&(c=this._lastWhen+1),this._lastWhen=c,this._eventQueue.push({When:c,Kind:b,Args:d}),a.isUserActionEvent(b)&&(this._lastUserAction=c))};d.prototype.enqueueFirst=function(a,b){0<this._eventQueue.length?this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a,Args:b}):this.enqueue(a,b)};d.prototype.disableRecording=
function(){this._recordingDisabled=!0;this.stopPipeline();a.disableConsole()};d.prototype.addUnload=function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this.singSwanSong())};d.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this.disableRecording()};d.prototype._flush=function(){this.processEvents();this._transport.flush()};d.prototype.prequeue=function(a,b){this._recordingDisabled||this._eventQueue.unshift({When:0,Kind:a,Args:b})};d.prototype.appendToQueue=
function(a){this._eventQueue=this._eventQueue.concat(a)};d.prototype.singSwanSong=function(){this._recordingDisabled||(this.processEvents(),this._transport.singSwanSong())};d.prototype.rebaseIframe=function(a){for(var b=0,d=this._eventQueue.length;b<d;b++){var e=this._eventQueue[b],g=e.When+this._ctx.startTime()-a;0>g&&(g=0);e.When=g}};d.prototype.processEvents=function(c){this._ctx.now()-this._lastUserAction>a.UserInactivityTimeout?this._quiescent||(this._quiescent=!0,this._heartbeatInterval=a.HeartbeatInitial,
this._lastHeartbeat=this._ctx.now()):this._quiescent=!1;if((!this._quiescent||this.maybeSendHeartbeat())&&null!=this._ctx.frameId()){var b=this._eventQueue;this._eventQueue=[];b=this._processor.processQueue(b);c||(b=b.concat(this._gatherExternalEvents()));this.ensureFrameIds(b);0!=b.length&&this._transport.enqueueEvents(b)}};d.prototype.maybeSendHeartbeat=function(){var c=this._ctx.now();return c-this._lastHeartbeat>=this._heartbeatInterval?(this._lastHeartbeat=c,this._heartbeatInterval*=2,this._heartbeatInterval>
a.HeartbeatMax&&(this._heartbeatInterval=a.HeartbeatMax),this.enqueue(a.EVENT_HEARTBEAT,[]),!0):!1};d.prototype.ensureFrameIds=function(a){var b=this._ctx.frameId();if(b)for(var d=this._ctx.parentIds(),e=d&&0<d.length,g=0;g<a.length;++g){var f=a[g];f.FId||(f.FId=b);e&&!f.PIds&&(f.PIds=d)}};d.prototype.stopPipeline=function(){this._pipelineStarted&&(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._eventQueue=[],this._transport.stopPipeline())};return d}();a.EventQueue=f})(l||
(l={}));(function(a){var k=function(){function f(a){this._queue=a;this._overflow=this._enabled=!1;this._total=0}f.prototype.enable=function(){var d=this;d._enabled||(d._enabled=!0,window.console?(console.log&&console.log.apply&&(d._oldLog=console.log,console.log=a.$entry(function(){d.addLog("log",arguments);return d._oldLog.apply(this,arguments)})),console.info&&console.info.apply&&(d._oldInfo=console.info,console.info=a.$entry(function(){d.addLog("info",arguments);return d._oldInfo.apply(this,arguments)})),
console.warn&&console.warn.apply&&(d._oldWarn=console.warn,console.warn=a.$entry(function(){d.addLog("warn",arguments);return d._oldWarn.apply(this,arguments)})),console.error&&console.error.apply&&(d._oldError=console.error,console.error=a.$entry(function(){d.addLog("error",arguments);return d._oldError.apply(this,arguments)}))):d.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),d._oldOnError=window.onerror,window.onerror=function(a,b,h){d.addError(a,b,h);if(d._oldOnError)return d._oldOnError.apply(this,
arguments)})};f.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&(console.error=this._oldError),window.onerror=this._oldOnError)};f.prototype.addLog=function(d,c){if(this.checkOverflow()){for(var b=[d],h=0;h<c.length;++h)b.push(a.stringify(c[h],20));this._queue.enqueue(a.EVENT_LOG,b)}};f.prototype.addError=function(d,c,b){this.checkOverflow()&&
this._queue.enqueue(a.EVENT_ERROR,[d,c,b])};f.prototype.checkOverflow=function(){if(this._overflow)return!1;if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",f.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};f.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';return f}();a.ConsoleWatcher=k})(l||(l={}));(function(a){a.UID_COOKIE="fs_uid";a.BAD_APP_IDS=" 0 1 -1 n/a nan undefined null nil the_id_that_you_use_in_your_app_for_this_user".split(" ");
var k=function(){function f(){this._cookie=null;this._cookies={}}f.prototype.initFromCookies=function(d,c,b){b=b.split(";");for(var h=0;h<b.length;h++){var e=b[h].replace(/^\s+|\s+$/g,"").split("="),g=e[0];this._cookies[g]||(this._cookies[g]=e[1])}this._cookie=f.parseCookie(this._cookies[a.UID_COOKIE]);if(this._cookie.Host!=d||this._cookie.OrgId!=c)this._cookie={Host:d,OrgId:c,UserId:"",SessionId:"",AppKey:"",Poisoned:!1}};f.prototype.initFromParsedCookie=function(a){this._cookie=a};f.parseCookie=
function(d){var c="",b="",h="",e="",g="",f=!1;if(d){var k=d.split("`");3>k.length?c=d:(h=k[0],e=k[1],c=k[2],5<=k.length&&(g=decodeURIComponent(k[3]),f="true"==k[4],0<=a.BAD_APP_IDS.indexOf(g)&&(a.logIfDebug('ignoring invalid app key "'+g+'" from cookie.'),g="",f=!1)))}d=c.indexOf(":");-1!=d&&(b=c.slice(d+1),c=c.slice(0,d));return{Host:h,OrgId:e,UserId:c,SessionId:b,AppKey:g,Poisoned:f}};f.prototype.host=function(){return this._cookie.Host};f.prototype.orgId=function(){return this._cookie.OrgId};f.prototype.userId=
function(){return this._cookie.UserId};f.prototype.sessionId=function(){return this._cookie.SessionId};f.prototype.appKey=function(){return this._cookie.AppKey};f.prototype.poisoned=function(){return this._cookie.Poisoned};f.prototype.cookieData=function(){return this._cookie};f.prototype.cookies=function(){return this._cookies};f.prototype.setCookie=function(a,c){var b=a+"="+c,b=this._domain?b+("; domain=."+encodeURIComponent(this._domain)):b+"; domain=";document.cookie=b+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};
f.prototype.setIds=function(a,c,b){if("localhost"==a||"127.0.0.1"==a)a="";this._domain=a;this._cookie.UserId=c;this._cookie.SessionId=b;this.write()};f.prototype.setAppId=function(d){d&&(d=d.trim());if(!d)return this._cookie.Poisoned?(a.logIfDebug("blocking FS.setUserVars API call due to mismatched user ID"),[!1,void 0]):[!0,void 0];if(d){var c=d.toLowerCase();if(0<=a.BAD_APP_IDS.indexOf(c))return a.logIfDebug("blocking FS.identify API call; uid value ("+d+") is illegal"),[!1,"fsidentity"]}if(this._cookie.AppKey&&
this._cookie.AppKey!=d)return a.logIfDebug("blocking FS.identify API call; existing uid ("+this._cookie.AppKey+") does not match provided uid ("+d+")"),this._cookie.Poisoned=!0,this.write(),[!1,"newuid"];this._cookie.AppKey=d;this._cookie.Poisoned=!1;this.write();return[!0,void 0]};f.prototype.encode=function(){var a=this._cookie.Host+"`"+this._cookie.OrgId+"`"+this._cookie.UserId+":"+this._cookie.SessionId;this._cookie.AppKey&&(a+="`"+encodeURIComponent(this._cookie.AppKey)+"`"+this._cookie.Poisoned);
return a};f.prototype.write=function(){null!=this._domain&&this.setCookie(a.UID_COOKIE,this.encode())};return f}();a.Identity=k})(l||(l={}));(function(a){var k=function(){function f(d,c){var b=this;this._queue=d;this._identity=c;this.AccountSystemVars={acctId:"str",displayName:"str",website:"str"};this.UserSystemVars={uid:"str",displayName:"str",email:"str"};this.VarTypes={str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&
0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return a?!isNaN(a.constructor===Date?a:new Date(a)):!1}};this._apiImpl=a.$entry(function(c,d){switch(c){case "account":if(b._identity.poisoned()){a.logIfDebug("blocking FS.identifyAccount API call due to mismatched user ID");break}b.setvar_api("acct",b.AccountSystemVars,d);break;case "user":var g=b._identity.setAppId(d.uid),f=g[1];if(!g[0]){switch(f){case "newuid":b._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["newuid",d.uid,
b._identity.appKey()]);break;case "fsidentity":b._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["fsidentity",d.uid]);break;case void 0:break;default:a.logIfDebug("unexpected failReason returned from setAppId: "+f)}break}b.setvar_api("user",b.UserSystemVars,d);break;default:a.logIfDebug('invalid operation "'+c+'"; only "account" and "user" are supported at present')}})}f.prototype.api=function(a,c){this._apiImpl(a,c)};f.prototype.processApiQueue=function(a){if(a)for(var c=0;c<a.length;c++)this.api(a[c][0],
a[c][1])};f.prototype.setvar_api=function(d,c,b){var f={},e;for(e in b)if(b.hasOwnProperty(e)){var g=b[e];a.logIfDebug("set-var('"+d+"'): \""+e+'" = '+a.stringify(g));var k=typeof g;if("object"!==k||g&&g.constructor==Date){var l,s;if(e in c)l=e,s=c[e];else{s=e.split("_");if(2!=s.length){a.logIfDebug('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["varname",d+":"+e]);continue}-1!=e.indexOf(" ")?(l=e.replace(/ /g,
""),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["varname",d+":"+e]),a.logIfDebug("Warning: variable '"+e+"' has spaces in it, which is disallowed. Converted name to '"+l+"'.")):l=e;s=s[1]}s in this.VarTypes?this.VarTypes[s](g)?("str"==s&&(g=g.trim()),"date"==s&&(g=this.toIsoString(g)),f[l]=g):(a.logIfDebug("illegal value "+a.stringify(g)+" for type "+s),"number"===k?k=0==g-Math.floor(g)?"integer":"real":"object"==k&&(null!=g&&g.constructor==Date)&&(k=isNaN(g)?"invalid date":"date"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,
["vartype",d+":"+e,k])):(a.logIfDebug('invalid type "'+s+'"'),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["varname",d+":"+e]))}else g instanceof Array&&(k="array"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["vartype",d+":"+e,k+" (unsupported)"])}this._queue.enqueue(a.EVENT_SYS_SETVAR,[d,a.stringify(f)])};f.prototype.toIsoString=function(a){return(a.constructor===Date?a:new Date(a)).toISOString()};return f}();a.Vars=k})(l||(l={}));(function(a){function k(){if("baseURI"in document)return document.baseURI;
var a=document.getElementsByTagName("base")[0];return a&&a.href?a.href:location.href}function f(a){if(J&&a){var b=document.createElement("script");b.text=a;b.async=!0;document.head.appendChild(b)}}function d(b){t.setIds(b.CookieDomain,b.UserIntId,b.SessionIntId);O=b.PageIntId;W=b.EmbedToken;a.logIfDebug("/User,"+t.userId()+"/Session,"+t.sessionId()+"/Page,"+O);K.setHost(b.BundleDomain?b.BundleDomain:t.host());X=b.IntegrationScript;f(b.IntegrationScript)}function c(){var a=document.doctype;if(!a)return null;
var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+'"');a.systemId&&(b+=' "'+a.systemId+'"');return b+">"}function b(){var b=document.documentElement,e=window._fs_hash,g=window._fs_replay_flags;if(L)b={OrgId:t.orgId(),UserId:t.userId(),Url:location.href,Base:k(),ScreenWidth:window.screen.width,ScreenHeight:window.screen.height,Width:b.clientWidth,Height:b.clientHeight,Referrer:document.referrer,Doctype:c(),Hash:e},g&&(b.ReplayFlags=g),a.doPost(F,C,"/rec/page",a.stringify(b),function(b){var e;
try{e=a.parseJson(b)}catch(g){h();return}d(e);if(window._fs_ready)try{window._fs_ready()}catch(f){a.logIfDebug("exception in _fs_ready(): "+f)}for(b=0;b<e.Blocks.length;++b)try{a.BlockRule.isComment(e.Blocks[b].Selector)||y.addRule(e.Blocks[b])}catch(fa){a.logIfDebug("Unexpected error parsing block rule. Skipping "+e.Blocks[b])}v.enqueueFirst(a.EVENT_SET_FRAME_BASE,[k(),c()]);v.startPipeline()},function(a){h()});else{a.logIfDebug("Unable to record playback stream.");var f=document.createElement("script");
window.__fs_startResponse=function(a){d(a);document.body.removeChild(f)};f.src="//"+t.host()+"/rec/page?OrgId="+t.orgId()+"&UserId="+t.userId()+"&Url="+encodeURIComponent(location.href)+"&Base="+encodeURIComponent(k())+"&ScreenWidth="+window.screen.width+"&ScreenHeight="+window.screen.height+"&Width="+b.clientWidth+"&Height="+b.clientHeight+"&Referrer="+encodeURIComponent(document.referrer)+"&Doctype="+encodeURIComponent(c())+"&Fallback=true"+(g?"&ReplayFlags="+g:"")+(e?"&Hash="+e:"");document.body.appendChild(f)}}
function h(){v.disableRecording();V();a.logIfDebug("Disabling FS.");if(window._fs_ready)try{window._fs_ready(!0)}catch(b){a.logIfDebug("exception in _fs_ready(): "+b)}}function e(){G.enable()}function g(){G&&G.disable()}function l(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];"log"!==a&&("info"!==a&&"warn"!==a&&"error"!==a&&"debug"!==a)&&(b.unshift(a),a="log");G.addLog(a,b)}function m(){"_fs_ext_debug"in window?M=!!window._fs_ext_debug:"_fs_debug"in window&&(M=!!window._fs_debug);
if("_fs_host"in window||"_fs_ext_host"in window)if("_fs_org"in window||"_fs_ext_org"in window){C=window._fs_ext_host||window._fs_host;var c=window._fs_ext_org||window._fs_org;a.logIfDebug("host: "+C);a.logIfDebug("orgid: "+c);"localhost:8080"==C&&(F="http:");r(c);x=A?null:0;K=A?new a.PostMessageEventTransport:new a.XHREventTransport(P,C,F,function(){v.disableRecording()});v=new a.EventQueue(P,K,function(){return D.bundleEvents()});y=new a.Blocker;D=new a.EventWatcher(P,v,y,ba);G=new a.ConsoleWatcher(v);
t=new a.Identity;Q=new a.Vars(v,t);e();L=!!window.MutationEvent;A?window._fs_run_in_iframe||window._fs_transport?parent.postMessage?$():(L=!1,a.logIfDebug("postMessage not supported")):a.logIfDebug("Fullstory recording for this page is NOT allowed within an iFrame."):(t.initFromCookies(C,c,document.cookie),y.addRule({Selector:"object",Kind:a.NYI_KIND}),y.addRule({Selector:"embed",Kind:a.NYI_KIND}),y.addRule({Selector:"canvas",Kind:a.NYI_KIND}),y.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND}),
y.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND}),Q.processApiQueue(window[a.Namespace()].q),delete window[a.Namespace()].q,b())}else a.logIfDebug("Missing global _fs_org. Recording disabled.");else a.logIfDebug("Missing global _fs_host. Recording disabled.")}function s(){return(new Date).getTime()}function r(a){if(window._fs_is_outer_script)A=!1;else if(window!=top)A=!0;else{var b=window._fs_transport;A=b&&b.init&&b.init(a)?!0:!1}}function q(){var a=function(){J||(J=!0,D.onDomLoad(),f(X))},b=!1;
switch(document.readyState){case "interactive":document.attachEvent||a();break;case "complete":a(),b||(b=!0,D.onLoad())}J||document.addEventListener("DOMContentLoaded",function(b){a()});b||window.addEventListener("load",function(c){a();b||(b=!0,D.onLoad())});A||(window.addEventListener("beforeunload",function(a){v.addUnload()}),window.addEventListener("unload",function(a){v.addUnload()}))}function w(){L&&(H=s(),q())}function u(a,b){Q.api(a,b)}function p(b,c,d){b&&"string"==typeof b?c&&"string"!=typeof c?
a.logIfDebug("setUid(): second argument (display name) must be a string"):(c||(c=b),d&&"object"!=typeof d?a.logIfDebug('setUid(): third argument (metadata) must be of the form {name0: "value0", name1: "value1", ...}'):(d=d?a.stringify(d):"",a.logIfDebug("setting uid: "+b+", meta: "+d),v.enqueue(a.EVENT_SYS_SETMETA,[b,c,d]))):a.logIfDebug("setUid(): first argument (user id) is required and must be a string")}function B(a){var b=z();if(!b)return null;a&&(b+=":"+s());return F+"//"+t.host()+"/ui/"+t.orgId()+
"/session/"+encodeURIComponent(b)}function z(){return t.userId()?t.userId()+":"+t.sessionId():null}function R(){return t.cookies()}function S(a,b){return t.setCookie(a,b)}function $(){window.addEventListener("message",function(b){if("string"==typeof b.data){var d=T(b.data);if(0!=d.length)if(d[0]==a.FS_SET_FRAME_ID_CMD)try{var e=d[1],g=d[2],f=d[3],h=d[4],l=d[5];if(e)if(x)a.logIfDebug("frame Id is already set to "+x+". Received second request to set it to "+e+" Iframe:"+location.href);else{a.logIfDebug("FrameId received within frame "+
location.href+": "+e);t.initFromParsedCookie(l);x=e;N=g;for(d=0;d<h.length;++d)y.addRule(h[d]);v.enqueueFirst(a.EVENT_SET_FRAME_BASE,[k(),c()]);v.rebaseIframe(f);H=f;v.startPipeline();if(0<I.length){for(d=0;d<I.length;d++)I[d]();I=[]}}else a.logIfDebug("Outer page gave us a bogus frame Id! Iframe: "+location.href)}catch(m){a.logIfDebug("Failed to parse frameId from message"+b.data)}else d[0]==a.FS_DISABLE_RECORDING?(v.disableRecording(),V()):b.source==parent&&a.logIfDebug("Invalid _fs postmessage command: "+
d[0])}});x||(0==x?a.logIfDebug("For some reason the outer window attempted to request a frameId"):(a.logIfDebug("Asking for a frame ID from within frame: "+location.href),a.postMessageParent(a.FS_REQUEST_FRAME_ID)))}function T(b){try{var c=a.parseJson(b);if("__fs"in c)return c.__fs}catch(d){}return[]}function V(){for(var b=0;b<E.length;b++){var c=E[b];c.contentWindow&&c.contentWindow.postMessage&&c.contentWindow.postMessage(a.stringify({__fs:[a.FS_DISABLE_RECORDING]}),"*")}}function aa(){window.addEventListener("message",
function(b){if("string"==typeof b.data){var c=T(b.data);if(0!=c.length)if(c[0]==a.FS_IFRAME_EVENTS)b=c[1],0<b.length&&K.enqueueEvents(b);else{var d;a:{d=b.source;for(var e=0;e<E.length;e++)if(E[e].contentWindow==d){d=a.fsid(E[e]);break a}a.logIfDebug("Unable to locate frame for window");d=NaN}c[0]==a.FS_REQUEST_FRAME_ID?b.source&&d?(a.logIfDebug("Responding to FID request for frame "+d),U(b.source,d)):a.logIfDebug("No FrameId found. Hoping to send one later."):A||NaN!=d&&a.logIfDebug("Invalid _fs postmessage command: "+
c[0]+" sent from child FrameId: "+d)}}})}function U(b,c){var d=function(){var d=[];0!=x&&(d=N?N.concat(x):[x]);b.postMessage(a.stringify({__fs:[a.FS_SET_FRAME_ID_CMD,c,d,H,y.rawRules,t.cookieData()]}),"*")};null==x?I.push(d):d()}function Y(b){a.logIfDebug("Injecting into Frame ["+b.src+"]");try{if(b.src&&("about:blank"!=b.src&&0>b.src.indexOf("javascript:"))&&b.src!=b.contentWindow.location.href)a.logIfDebug("Frame not yet loaded: "+b.src);else if(b.contentWindow[a.Namespace()])a.logIfDebug("FS already defined in Frame contentWindow: "+
b.src+". Ignoring.");else{var c=b.contentDocument,d="var _fs_org='"+t.orgId()+"', _fs_host='"+t.host()+"', _fs_run_in_iframe=true, _fs_debug="+M+"; (function(w,a,t){a=w.createElement('script');a.async=1;a.src='"+F+"//'+_fs_host+'/s/fs.js';w.head.appendChild(a)})(document);",e=c.createElement("script");e.textContent=d;c.head.appendChild(e)}}catch(f){a.logIfDebug("iFrame no injecty. Probably not same origin.")}}function ba(b,c){var d=a.fsid(c);d?(Z||(aa(),Z=!0),ca(d,c)):a.logIfDebug("fsid missing or invalid for iFrame."+
c.src)}function ca(b,c){E.push(c);da(c)?(a.logIfDebug("Attempting to setup Frame ["+c.src+"]"),Y(c),c.addEventListener("load",function(b){a.logIfDebug("onload for frame ["+c.src+"]");Y(c)})):(a.logIfDebug("Frame Doesn't need injecting. Probably cross domain ["+c.src+"]"),c.contentWindow.postMessage&&(a.logIfDebug("Eagerly sending FrameId "+b+" to Frame ["+c.src+"]"),U(c.contentWindow,b)))}function da(a){var b=a.src;return!a.hasAttribute("src")||"about:blank"==b||0==b.indexOf("javascript:")||0==b.indexOf(ea)}
a.Setup=function(){if(!a.isLoaded()){var b=a.Namespace();a.setLoaded(b);window[b].setUid=a.$entry(p);window[b].getCurrentSessionURL=a.$entry(B);window[b].getCurrentSession=a.$entry(z);window[b].enableConsole=a.$entry(e);window[b].disableConsole=a.$entry(g);window[b].log=a.$entry(l);window[b]._api=u;window[b]._cookies=R;window[b]._setCookie=S;m();w()}};var M=!1,C,F="https:",O,x,N,ea=window.location.protocol+"//"+window.location.host,A,L,H=s(),J=!1,X=null,Z,W,P={startTime:function(){return H},now:function(){return s()-
H},wallTime:s,identity:function(){return t},pageId:function(){return O},baseUri:k,frameId:function(){return x},parentIds:function(){return N},addWindowScroll:function(){D.addWindowScroll()}},v,y,D,G,K,t,Q;window._fs_shutdown=function(a){v.shutdown();a&&(a=document.getElementById(a))&&a.setAttribute("_fs_embed_token",W)};a.enableConsole=e;a.disableConsole=g;a.log=l;a._init=m;a._record=w;a.isDebug=function(){return M};a._api=u;a.setUid=p;a.getCurrentSessionURL=B;a.getCurrentSession=z;a._cookies=R;a._setCookie=
S;a.FS_REQUEST_FRAME_ID="RequestFrameId";a.FS_SET_FRAME_ID_CMD="SetFrameId";a.FS_IFRAME_EVENTS="EvtBundle";a.FS_DISABLE_RECORDING="DisableRecording";var E=[],I=[]})(l||(l={}));try{l.Setup()}catch(z){window._fs_debug&&window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();
